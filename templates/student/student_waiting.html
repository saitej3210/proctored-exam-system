<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Exam Waiting Room</title>

<style>
body{
  background:#0f172a;
  color:#e5e7eb;
  font-family:Segoe UI, sans-serif;
  display:flex;
  align-items:center;
  justify-content:center;
  height:100vh;
}
.card{
  background:#020617;
  border-radius:16px;
  padding:30px;
  width:360px;
  text-align:center;
}
.badge{
  margin:15px 0;
  padding:12px;
  border-radius:12px;
  font-weight:600;
}
.waiting{
  background:rgba(234,179,8,.15);
  color:#fde047;
}
.approved{
  background:rgba(34,197,94,.15);
  color:#4ade80;
}
.instructions{
  margin-top:20px;
  text-align:left;
  background:rgba(255,255,255,.05);
  padding:15px;
  border-radius:12px;
  font-size:14px;
}
</style>
</head>

<body>

<div class="card">
  <h2>üìÑ Exam Waiting Room</h2>

  <div id="statusBox" class="badge waiting">
    ‚è≥ Waiting for Admin Approval
  </div>

  <div class="instructions">
    <b>‚ö† Exam Instructions</b>
    <ul>
      <li>Full screen mode is mandatory</li>
      <li>Tab switching is monitored</li>
      <li>All answers are auto-saved</li>
      <li>Leaving exam may require re-approval</li>
    </ul>
  </div>
</div>

<script>
const EXAM_ID = {{ exam_id }};

async function checkStatus(){
  try{
    const res = await fetch(`/student/waiting/status/${EXAM_ID}`, {
      cache: "no-store"
    });
    const data = await res.json();

    const box = document.getElementById("statusBox");

    if(data.status === "WAITING"){
      box.className = "badge waiting";
      box.innerText = "‚è≥ Waiting for Admin Approval";
    }

    if(data.status === "APPROVED"){
      box.className = "badge approved";
      box.innerText = "‚úÖ Approved by Admin\nWaiting for exam to start";
    }

    if(data.status === "RUNNING"){
      window.location.href = `/student/exam/${EXAM_ID}`;
    }

    if(data.status === "LEFT" || data.status === "LOGOUT"){
      window.location.href = "/student/login";
    }

  }catch(e){
    console.error("Status check failed", e);
  }
}

setInterval(checkStatus, 2000);
</script>

</body>
</html>